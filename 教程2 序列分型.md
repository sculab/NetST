# 教程2：序列分型

**总结：介绍NetST核心功能之一——序列分型（包含序列单一分型以及序列混合分型）。本教程描述了在具有序列分型参考数据的基础上，如何使用NetST鉴定未知序列的分型。**

本教程中所有使用的文件都存储在文件夹DEMOS/DEMO_02下。如果你是NetST的初学者或是想要了解关于构建单倍型网络相关的教程，请从教程1开始。

## 序列分型

注意：在本教程中，序列分型是在已知部分序列分型的基础上，利用已知序列的分型，对未知序列分型做鉴定。主要分为两类：序列单一分型（即一条序列只具有一个确定的分型）和序列混合分型（即一条序列可能具有不同的分型或该条序列是某几个分型序列的杂合）。

### 序列单一分型

注意：本教程中的序列分型建立在已知部分序列分型的基础上，利用已知分型数据进行未知序列分型鉴定。因此需要用户提供参考数据，NetST将根据用户提供的参考数据建立参考数据集，用作未知序列分型。因此序列分型的流程包含【载入参考文件 > 构建参考数据集 > 载入未知分型序列 > 未知序列分型】

### 载入参考文件

打开【文件 > 载入序列】导航到DEMOS/DEMO_02/HA_REFS.fasta并选择它，而后将序列进行标准化，获取序列相关的分型信息。该步骤可以参考教程1中的载入文件部分。将序列导入后，将得到下面的窗口：

![image-20230822233827580](https://cdn.jsdelivr.net/gh/plant720/TyporaPic/img/202308222338671.png)



打开【文件 > 导出分型】并导航到一个自定义文件夹（这里是HA_DATA）中，用于保存参考序列的分型信息。结果文件夹的文件目录如下图：

![image-20230822234222384](https://cdn.jsdelivr.net/gh/plant720/TyporaPic/img/202308222342421.png)

NetST将不同分型的数据合并到不同的分型文件中，并提供了一个存放所有参考序列的文件。

注意：该文件夹可以作为参考数据一直使用，当增添了新的分型序列后，可重新使用NetST制作。

### 载入测试序列

打开【文件 > 载入序列】导航到DEMOS/DEMO_02/HA_TEST.fasta并选择它，进行序列标准化，将获得下面的序列信息：

![image-20230823000403549](https://cdn.jsdelivr.net/gh/plant720/TyporaPic/img/202308230004608.png) 

测试文件中包含了10条未知分型的数据，想检测这些序列的分型。打开【分析 > 快速分型/鉴定 > 使用自定义参考序列】并导航到DEMOS/DEMO_02/HA_DATA/ref_combine.fasta并选择该文件作为参考序列。此时后台将打开一个命令行界面，并运行相关分析。当后台分析结束，NetST的界面将出现以下结果窗口：

![image-20230823002327120](https://cdn.jsdelivr.net/gh/plant720/TyporaPic/img/202308230023160.png)

上述结果显示测试文件中的10条未知分型的序列的分型均是H5。

### 序列混合分型

在实际分析序列时，序列的分型可能不是唯一确定的，那么就需要进行序列混合分型，用于确定序列可能的分型以及该序列同可能的分型的其他的序列之间的关系。

在上述序列单一分型的结果界面，打开【分析 > 混合分型分析】，在选择参考数据集时导航到DEMOS/DEMO_02/HA_DATA并选择整个文件夹，并自定义一个结果文件夹（这里是test_result）用于获取混合分型结果。

![image-20230823003303648](https://cdn.jsdelivr.net/gh/plant720/TyporaPic/img/202308230033700.png)

在经过后台分析后，将得到下面的结果：

![image-20230823004025926](https://cdn.jsdelivr.net/gh/plant720/TyporaPic/img/202308230040978.png)

序列混合分型的结果显示测试文件中的10条序列中seq_04和seq_09这两条序列有可能是混合序列（即该序列不具有唯一确定的分型或该序列是两种分型序列的混合序列）。在刚才自定义的结果文件夹test_result中，可以看到NetST将可能的混合序列同其可能的分型序列放置在一个文件中，便于用户更近一步的鉴定未知序列同其他分型序列的关系。

![image-20230823152456027](https://cdn.jsdelivr.net/gh/plant720/TyporaPic/img/202308231524081.png)

下面的具体鉴定以seq_04为例，鉴定unknown的seq_04更贴近于哪个分型。打开【文件 > 载入序列】导航到DEMOS/DEMO_02/test_result/4.fasta并选择该文件，对序列进行标准化，而后构建TCS单倍型网络。

![image-20230823152421048](https://cdn.jsdelivr.net/gh/plant720/TyporaPic/img/202308231524204.png)

得到下面的结果窗口：
![image-20230823153221891](https://cdn.jsdelivr.net/gh/plant720/TyporaPic/img/202308231532946.png)

根据网络图的结果，我们可以很容易发现，分型未知的seq_04跟贴近于H7分型。
